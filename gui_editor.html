<!-- There's no harm in users accessing this page, but you can remove it if you'd like -->
<!-- In GH Pages you can also rename it to start with an `_` and it will 404 -->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>GUI Data Editor</title>
    <script src="https://cdn.jsdelivr.net/npm/@json-editor/json-editor@latest/dist/jsoneditor.min.js"></script>
    <link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let dataFetch = fetch('./data.json').then((response) => response.json());
            let schemaFetch = fetch('./data.schema.json').then((response) => response.json());

            Promise.all([dataFetch, schemaFetch]).then((response) => {setup(response[0], response[1])});
        });

        function setup(data, schema) {
            var editor = new JSONEditor(document.getElementById('editor_holder'), {
                schema: schema,
                startval: data,

                disable_edit_json: true,
                disable_properties: true,
                disable_collapse: true,

                theme: 'spectre',
                iconlib: 'fontawesome5'
            });

            document.getElementById('submit').addEventListener('click', function () {
                navigator.clipboard.writeText(JSON.stringify(editor.getValue(), null, 2));
                console.log(editor.getValue());
            });

        }
    </script>
    <style>
        #submit {
            top: 4px;
            right: 50%;
        }
    </style>
</head>

<body class="container grid-md p-2">
    <h1>GUI Data Editor</h1>
    <p class="mb-0">On Load, the current values from <code>data.json</code> are used.</p> 
    <p>Make any desired edits then click the copy button and paste the result back into <code>data.json</code> to update the site contents.</p>
    <button id='submit' class="btn btn-lg btn-primary float-right">Copy Data to Clipboard</button>
    <div id='editor_holder'></div>


</body>

</html>